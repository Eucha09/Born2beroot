## SSH

- Secure Sell
- 원격지에 있는 컴퓨터를 안전하게 제어하기 위한 프로토콜 또는 이 프로토콜을 사용하는 프로그램들을 의미한다.
- SSH 클라이언트와 SSH 서버의 관계로 상호작용하면서 SSH 서버가 설치된 운영체제를 제어한다.
- 클라이언트와 서버 사이에는 강력한 암호화 방법을 통해서 연결되어 있기 때문에 데이터를 중간에서 가로채도 해석 할 수 없는 암호화된 문자만이 노출된다.
- 지금까지는 Telnet을 주로 사용했는데 이것을 대체하기 위한 통신 방법이다.

**SSH 클라이언트**
- 리눅스와 Max과 같은 Unix 계열의 운영체제는 기본적으로 SSH 클라이언트가 설치 되어 있기 때문에 SSH를 이용하기 위해서 특별한 클라이언트가 필요하지 않다.
- 하지만 SSH는 윈도우 운영체제에는 SSH 클라이언트가 설치되어 있지 않다. 따라서 SSH 클라이언트를 설치해야하는데 대표적인 SSH 클라이언트는 PuTTY, Xshell이 있다.

**SSH 서버**
- 유닉스 계열의 운영체제에서는 OpenSSH가 가장 많이 사용된다. OpenSSH는 SSH 클라이언트와 서버를 포함한다. - Mac은 SSH 클라이언트와 서버가 이미 설치 되어 있다.

**SSH Key**
- 서버에 접속 할 때 비밀번호 대신 Key를 제출하는 방식이다.
- SSH Key는 언제 사용하는가?
	- 비밀번호 보다 높은 수준의 보안을 필요로 할 때
	- 로그인 없이 자동으로 서버에 접속 할 때

**SSH Key가 동작하는 방식**
- **비대칭키 방식**   
	가장 먼저 사용자와 서버가 서로의 정체를 증명해야 한다. 이 시점에서 사용되는 것이 비대칭키 방식이다. 비대칭키 방식에서는 서버 또는 사용자가 Key Pair(키 페어, 키 쌍)를 생성한다. 키 페어는 공개 키와 개인 키의 두 가지로 이루어진 한 쌍을 뜻하며, 보통 공개 키의 경우 .pub, 개인 키의 경우 .pem의 파일 형식을 띄고 있다.

	예를 들어 사용자가 키 페어를 생성했을 경우, 공개 키를 서버에 전송한다. 공개 키는 말 그대로 ‘공개’된 키이기 때문에 누구나 가질 수 있다. 때문에 전송과정에서 유출되어도 크게 문제가 되지 않는다. 서버는 공개 키를 받아서, 이 공개 키로 만들어진 랜덤한 값을 생성한다. 이 값은 사용자가 올바른 키 페어를 가지고 있는지 시험하는 일종의 시험지와 같다.

	시험지를 받은 사용자는 가지고 있는 개인 키를 이용해 이 시험지를 푼다. 다른 공개 키나 개인 키를 이용해서는 풀 수 없다. 오직 키 페어 생성 시 함께 생성된 개인 키와 공개 키만 서로 해석이 가능하다.

	개인 키는 공개 키와 달리 다른 어디에도 보여주지 않는 소중한 파일이다. 그래서 결과적으로 개인 키가 서버와 사용자 간의 사이를 증명하는 수단이 된다. 다시 과정으로 돌아와서, 시험지를 풀어서 나온 값을 사용자는 다시 서버에 전송한다.

 	서버는 사용자로부터 전송받은 값을 자신이 처음에 낸 값과 비교한다. 두 값이 같게 되면 서버는 “이 사용자는 내 공개 키에 대응하는 올바른 개인 키를 보유하고 있으니, 내가 아는 사용자가 맞다!” 라고 판단하고 접속을 허용해준다. 이렇게 최초 접속 시 사용자와 서버 간의 인증 절차가 비대칭키 방식을 통해 완료된다.
- **대칭키 방식**   
	서로가 누군지를 알았으니 이제 정보를 주고받을 차례이다. 주고받는 과정에서 정보가 새어나가지 않기 위해 정보를 암호화해서 주고받는데, 여기서 사용되는 과정이 대칭키 방식이다. 대칭키 방식에서는 비대칭키 방식과 달리 한 개의 키만을 사용하는데, 우리는 이것을 대칭 키라고 한다.

 	예를 들어보면 사용자 또는 서버는 하나의 대칭 키를 만들어 서로 공유한다. 공유된 대칭 키를 이용해 정보를 암호화하면, 받은 쪽에서 동일한 대칭 키로 암호를 풀어 정보를 습득하게 된다. 정보 교환이 완료되면 교환 당시 썼던 대칭 키는 폐기되고, 나중에 다시 접속할 때마다 새로운 대칭 키를 생성하여 사용하게 된다.

### SSH 상태 확인

```systemctl status ssh```

### SSH 설정 확인

```vi /etc/ssh/sshd_config```

### Client에서 SSH를 통해 Server(가상머신) 접속

```shell
ssh <계정이름>@<서버주소> -p <포트번호>
#ex) ssh eujeong@10.28.4.9 -P 4242
```